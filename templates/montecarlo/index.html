{% extends 'base/base.html' %}
{% load staticfiles %}

{% block title %} Método Monte Carlo{% endblock %}

{% block css %}
    <link rel="stylesheet" href="{% static 'css/estilo.css' %}">

    <!--Bootstrap -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
          crossorigin="anonymous">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"
          type="text/css">

    <link rel="stylesheet" href="{% static 'css/multi-step-form.css' %}" type="text/css">
    <style type="text/css">
        body {
            font-family: montserrat, arial, verdana;
        }
    </style>
{% endblock %}

{% block header %}


    <div id="container body-content">

        <form class="form-horizontal reg_form" id="formulario" method="post">
            <h1>Generar Método Monte-Carlo</h1>

            {% csrf_token %}


            <div class="form-group">
                <div class="inputGroupContainer">
                    <span class="input-group-addon">Numeros de x y f</span>

                    <div class="input-group-lg">
                        <input required type="number" class="form-control input-lg" id="inputGroupSuccess1"
                               aria-describedby="inputGroupSuccess1Status" name="n"
                               placeholder="¿Cuantos Datos va a ingresar?">
                    </div>
                </div>
            </div>
            <select hidden name="metodo">
                <option selected value="numeros">Numeros</option>
            </select>
            <input class=" action-button"
                   type="submit" value="Continuar">
        </form>
        {% if num >= 1 %}
            <div class="panel panel-success">
                <div class="progress">
                    <div class="progress-bar progress-bar-success progress-bar-striped" role="progressbar"
                         aria-valuenow="0"
                         aria-valuemin="0" aria-valuemax="100" style="width: 0%">
                        <span class="sr-only">0% Complete</span>
                    </div>
                </div>
                <div class="panel-heading">
                    Formulario
                </div>
                <div class="panel-body">
                    <form class="form-horizontal msf reg_form" method="post">
                        {% csrf_token %}
                        <div class="msf-header">
                            <div class="row text-center">
                                <div class="msf-step col-md-4"><i class="fa fa-clipboard"></i> <span>Ingrese Valores de X y Probabilidad</span>
                                </div>
                                <div class="msf-step col-md-4"><i class="fa fa-credit-card"></i><span>Seleccione el método e ingrese Datos</span>
                                </div>
                                <div class="msf-step col-md-4"><i class="fa fa-check"></i>
                                    <span>Verificar Datos</span></div>
                            </div>
                        </div>

                        <div class="msf-content">
                            <div class="msf-view">

                                <div class="row">
                                    <div class="col-md-6 col-md-offset-3">


                                            <table class="table table-bordered table-striped table-hover"
                                                   >
                                                <tr>
                                                    <th>
                                                        Nombre de X

                                                    </th>
                                                    <th>
                                                        Nombre de Frecuencia
                                                    </th>
                                                </tr>
                                                <tr>
                                                    <th>
                                                         <div class="form-group ">
                                                                    <div class="inputGroupContainer col-md-10 col-md-offset-1">

                                                                        <div class="input-group">
                                                                            <input required type="text" class="form-control input-lg"
                                                               id="inputGroupSuccess2"
                                                               aria-describedby="inputGroupSuccess2Status" name="nx"
                                                               placeholder="Nombre de X">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                       </th>
                                                    <th>
                                                         <div class="form-group">
                                                                    <div class="inputGroupContainer col-md-10 col-md-offset-1">

                                                                        <div class="input-group">
                                                                               <input required type="text" class="form-control input-lg"
                                                               id="inputGroupSuccess3"
                                                               aria-describedby="inputGroupSuccess3Status" name="nfre"
                                                               placeholder="Nombre de Frecuencia">
                                                                        </div>
                                                                    </div>
                                                                </div>


                                                    </th>
                                                </tr>
                                                <tr>
                                                    <th>Valores de X
                                                    </th>
                                                    <th>Valores de Frecuencia
                                                    </th>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <ul>
                                                            {% for num  in num %}
                                                                <div class="form-group">
                                                                    <div class="inputGroupContainer col-md-10 col-md-offset-1">
                                                                        <div class="input-group"><span
                                                                                class="input-group-addon">{{ num }}</span>
                                                                            <input id="vx{{ num }}" type="text"
                                                                                   class="form-control input-lg"
                                                                                   aria-describedby="inputGroupSuccess1Status"
                                                                                   name="vx"
                                                                                   placeholder="Valor de X {{ num }}"
                                                                                   data-val="true"
                                                                                   data-val-required="vx{{ num }} is required">
                                                                        </div>
                                                                    </div>
                                                                </div>




                                                            {% endfor %}
                                                        </ul>
                                                    </td>
                                                    <td>
                                                        {% for num in num %}

                                                            <div class="form-group">
                                                                <div class="inputGroupContainer col-md-10 col-md-offset-1">
                                                                    <div class="input-group" ><span
                                                                            class="input-group-addon">{{ num }}</span>
                                                                        <input required type="number" step="0.00001"
                                                                               class="form-control input-lg"
                                                                               id="vfre{{ num }}"
                                                                               aria-describedby="inputGroupSuccess5Status"
                                                                               name="vfre"
                                                                               placeholder="Valor de Frecuencia {{ num }}"
                                                                               data-val="true"
                                                                               data-val-required="vfre{{ num }} is required">
                                                                    </div>
                                                                </div>
                                                            </div>


                                                        {% endfor %}
                                                    </td>
                                                </tr>
                                            </table>


                                        <div class="form-group">
                                            <input hidden value="{{ nume }}" type="number" name="no"
                                                   placeholder="{{ nume }}">


                                            <select hidden name="metodo">
                                                <option selected value="valor_x">Valores de xx</option>
                                            </select>
                                        </div>

                                    </div>
                                </div>
                            </div>

                            <div class="msf-view">
                                <div class="row">
                                    <div class="col-md-6 col-md-offset-3">

                                        <div class="form-group">

                                            <select id="metodoa" onChange="mostrar(this.value)"
                                                    class="form-control input-lg"
                                                    name="metodoa" class="form-control"
                                                    data-bind="options: availablemetodoa, selectedOptions: chosenmetodoa, optionsCaption: 'Seleccione un método'"
                                                    data-val="true" data-val-required="Request metodoa is required.">
                                            </select>
                                        </div>
                                        <div class="card text-center">
                                            <div class="card-header">
                                                <label>Método</label> : <span data-bind="text: chosenmetodoa"></span>
                                            </div>
                                            <div class="card-body">

                                                <div class="form-group">

                                                    <div id="Multiplicativo" class="form-group has-feedback">
                                                        <label class="control-label" for="inputGroupSuccess1">Ingrese
                                                            datos:</label>

                                                        <div class="input-group">

                                                            <span class="input-group-addon">N</span>
                                                            <input required id="n" type="number"
                                                                   class="form-control input-lg"
                                                                   name="n" placeholder="Cantidad a Generar"
                                                                   data-bind="value: n"
                                                                   data-val="true"
                                                                   data-val-required="Request n is required.">
                                                        </div>

                                                        <div class="input-group">
                                                            <span class="input-group-addon">A</span>
                                                            <input required id="a" required type="number"
                                                                   class="form-control input-lg"
                                                                   aria-describedby="inputGroupSuccess2Status" name="a"
                                                                   placeholder="Constante Multiplicativa"
                                                                   data-bind="value: a"
                                                                   data-val="true"
                                                                   data-val-required="Request a is required.">
                                                        </div>

                                                        <div class="input-group">
                                                            <span class="input-group-addon">Xo</span>
                                                            <input id="xo" required type="number"
                                                                   class="form-control input-lg"
                                                                   id="inputGroupSuccess3"
                                                                   aria-describedby="inputGroupSuccess3Status" name="xo"
                                                                   placeholder="Semilla Inicial"
                                                                   data-bind="value: xo"
                                                                   data-val="true"
                                                                   data-val-required="Request xo is required.">
                                                        </div>
                                                        <div id="divc" class="input-group">
                                                            <span class="input-group-addon">C</span>
                                                            <input id="c" required type="number"
                                                                   class="form-control input-lg"
                                                                   id="inputGroupSuccess4"
                                                                   aria-describedby="inputGroupSuccess4Status" name="c"
                                                                   placeholder="Constante Aditiva"
                                                                   data-bind="value: c"
                                                                   data-val="true"
                                                                   data-val-required="Request c is required.">
                                                        </div>
                                                        <div class="input-group">
                                                            <span class="input-group-addon">M</span>
                                                            <input id="m" required type="number"
                                                                   class="form-control input-lg"
                                                                   id="inputGroupSuccess5"
                                                                   aria-describedby="inputGroupSuccess5Status" name="m"
                                                                   placeholder="Modulo"
                                                                   data-bind="value: m"
                                                                   data-val="true"
                                                                   data-val-required="Request m is required.">
                                                        </div>
                                                    </div>
                                                    <div id="Manual" class="input-group">
                                                        <span class="input-group-addon">Números manuales</span>
                                                        <input required type="text" id="cnumeros" name="cnumeros"
                                                               value=""
                                                               class="form-control input-lg">
                                                        <a href="#" id="nNumeros" onclick="addNumeros()">Generar
                                                            Campos</a>

                                                        <div id="ncontenido">


                                                        </div>
                                                    </div>
                                                </div>


                                            </div>

                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="msf-view">
                                <div class="row">
                                    <div class="col-md-6 col-md-offset-3">
                                        <label>Name</label> : <span data-bind="text: vx0"></span>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 col-md-offset-3">
                                        <label>Email</label> : <span data-bind="text: Email"></span>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 col-md-offset-3">
                                        <label>Método</label> : <span data-bind="text: chosenmetodoa"></span>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 col-md-offset-3">
                                        <label>Details</label> : <span data-bind="text: Details"></span>
                                    </div>
                                </div>


                            </div>
                        </div>


                        <div class="msf-navigation">
                            <div class="row">
                                <div class="col-md-3">
                                    <button type="button" data-type="back" class="btn btn-default msf-nav-button"><i
                                            class="fa fa-chevron-left"></i> Atrás
                                    </button>
                                </div>

                                <div class="col-md-3 col-md-offset-6">
                                    <button type="button" data-type="next" class="btn btn-default msf-nav-button">
                                        Siguiente
                                        <i
                                                class="fa fa-chevron-right"></i></button>

                                    <button type="submit" data-type="submit" class="btn btn-primary msf-nav-button">
                                        Submit
                                    </button>
                                </div>

                            </div>
                        </div>
                    </form>
                </div>
            </div>
            </div>
        {% endif %}

{% endblock %}

{% block content %}
    {% if mresultado != None %}


        <div class="panel panel-success">
            <div class="panel-heading">
                Tabla de Datos Monte Carlo
            </div>
            <div class="panel-body">
                <table class="table table-bordered table-striped table-hover" style="width:100%">
                    <tr>
                        <th>#</th>
                        <th>{{ nx }}</th>
                        <th>Frecuencia {{ nfre }}</th>
                        <th>Probabilidad</th>
                        <th>Frecuencia Acumulada</th>
                    </tr>

                    {% for datos  in datos %}
                        <tr>
                            <td> {{ datos.0 }} </td>
                            <td>  {{ datos.1 }}</td>
                            <td>  {{ datos.2 }}</td>
                            <td><b>{{ datos.2 }} / {{ sum }} = </b>{{ datos.3 }}</td>
                            <td>{{ datos.4 }}</td>
                        </tr>

                    {% endfor %}
                    <tr>
                        <td></td>
                        <th>Total:</th>
                        <td> {{ sum }}</td>
                    </tr>

                </table>
            </div>
        </div>



        <div class="panel-body">

            <table class="table table-bordered table-striped table-hover" style="width:100%">
                <tr>
                    <th>#</th>
                    <th>Desde</th>
                    <th>Hasta</th>
                    <th>{{ nx }}</th>
                </tr>
                <tr>
                    <td>

                        <ul class="list-group">
                            {% for datos  in mfrecd %}
                                <button type="button" class="list-group-item list-group-item-action">
                                    {{ datos.0 }}
                                </button>
                            {% endfor %}
                        </ul>

                    </td>
                    <td>

                        <ul class="list-group">
                            {% for datos  in mfrecd2 %}
                                <button type="button" class="list-group-item list-group-item-action">
                                    {{ datos }}
                                </button>
                            {% endfor %}
                        </ul>

                    </td>
                    <td>

                        <ul class="list-group">
                            {% for datos  in mfrecd %}
                                <button type="button" class="list-group-item list-group-item-action">
                                    {{ datos.2 }}
                                </button>
                            {% endfor %}
                        </ul>

                    </td>
                    <td>

                        <ul class="list-group">
                            {% for datos  in datos %}
                                <button type="button" class="list-group-item list-group-item-action">
                                    {{ datos.1 }}
                                </button>
                            {% endfor %}
                        </ul>

                    </td>


                </tr>


            </table>
        </div>

        <div class="panel-body">
            <table class="table table-bordered table-striped table-hover" style="width:100%">

                <tr>
                    <th># Evento</th>
                    <th>Numero Aleatorio</th>
                    <th>Frecuencia Seleccionada</th>
                    <th>Resultado {{ nx }}</th>
                </tr>

                {% for datos  in mresultado %}
                    <tr>
                        <td> {{ datos.0 }} </td>
                        <td>  {{ datos.1 }}</td>
                        <td>  {{ datos.2 }}</td>
                        <td>  {{ datos.3 }}</td>

                    </tr>

                {% endfor %}


            </table>
        </div>

        <div id="chart_div" style="width: 900px; height: 500px;"></div>

    {% endif %}
{% endblock %}
{% block js %}

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {'packages': ['corechart']});
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            var data = google.visualization.arrayToDataTable([
                ['Age', 'Weight'],
                [8, 12],
                [4, 5.5],
                [11, 14],
                [4, 5],
                [3, 3.5],
                [6.5, 7]
            ]);

            var options = {
                title: 'Age vs. Weight comparison',
                hAxis: {title: 'Age', minValue: 0, maxValue: 15},
                vAxis: {title: 'Weight', minValue: 0, maxValue: 15},
                legend: 'none'
            };

            var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

            chart.draw(data, options);
        }
    </script>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.2/knockout-min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.16.0/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.6/jquery.validate.unobtrusive.min.js"></script>


    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>
    <script src="{% static 'js/multi-step-form.js' %}"></script>
    <script type="text/javascript">
        function ViewModel() {
            var self = this;

            self.Name = ko.observable('');
            self.Email = ko.observable('');
            self.Details = ko.observable('');

            self.AdditionalDetails = ko.observable('');
            self.availablemetodoa = ko.observableArray(['Lineal', 'Multiplicativo', 'Manual']);
            self.chosenmetodoa = ko.observable('');


        }

        var viewModel = new ViewModel();

        ko.applyBindings(viewModel);

        $(document).on("msf:viewChanged", function (event, data) {

            var progress = Math.round((data.currentIndex / data.totalSteps) * 100);

            $(".progress-bar").css("width", progress + "%").attr('aria-valuenow', progress);
            ;
        });


        $(".msf:first").multiStepForm();


        function addNumeros() {
            // Number of inputs to create
            var number = document.getElementById("cnumeros").value;


            // Container <div> where dynamic content will be placed
            var container = document.getElementById("ncontenido");
            // Clear previous contents of the container
            while (container.hasChildNodes()) {
                container.removeChild(container.lastChild);
            }
            for (i = 0; i < number; i++) {
                // Append a node with a random text
                container.appendChild(document.createTextNode("Número " + (i + 1)));
                // Create an <input> element, set its type and name attributes
                var input = document.createElement("input");
                input.type = "number";
                input.step = "0.00001";
                input.className = "form-control input-lg";
                input.name = "nmanual";
                input.required = "true";
                container.appendChild(input);
                // Append a line break
                container.appendChild(document.createElement("br"));
            }
        }

        function mostrar(id) {


            if (id == "Multiplicativo") {
                var n = document.getElementById("n");
                n.setAttribute("value", "");
                var m = document.getElementById("m");
                m.setAttribute("value", "");
                var xo = document.getElementById("xo");
                xo.setAttribute("value", "");
                var a = document.getElementById("a");
                a.setAttribute("value", "");
                var c = document.getElementById("c");
                c.setAttribute("value", "2");

                $("#Manual").hide();
                $("#divc").hide();
                $("#Lineal").hide();

                $("#Multiplicativo").show();

            }
            if (id == "Manual") {
                $("#Multiplicativo").hide();
                $("#Lineal").hide();
                $("#Manual").show();

                var n = document.getElementById("n");
                n.setAttribute("value", "2");
                var m = document.getElementById("m");
                m.setAttribute("value", "2");
                var xo = document.getElementById("xo");
                xo.setAttribute("value", "2");
                var a = document.getElementById("a");
                a.setAttribute("value", "2");
                var c = document.getElementById("c");
                c.setAttribute("value", "2");


            }
            if (id == "Lineal") {
                var n = document.getElementById("n");
                n.setAttribute("value", "");
                var m = document.getElementById("m");
                m.setAttribute("value", "");
                var xo = document.getElementById("xo");
                xo.setAttribute("value", "");
                var a = document.getElementById("a");
                a.setAttribute("value", "");
                var c = document.getElementById("c");
                c.setAttribute("value", "");

                $("#Multiplicativo").show();
                $("#divc").show();
                $("#Manual").hide();


            }
            if (id == "") {
                $("#Multiplicativo").hide();
                $("#Lineal").hide();
                $("#Manual").hide();
            }

        }
    </script>

{% endblock %}
